<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="RcloneGui.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:RcloneGui"
    xmlns:views="using:RcloneGui.Views"
    xmlns:vm="using:RcloneGui.ViewModels"
    xmlns:tb="using:H.NotifyIcon"
    Title="Rclone GUI - SFTP Drive Mounter">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Title Bar -->
        <Grid Grid.Row="0" Padding="16,12" Background="{ThemeResource SolidBackgroundFillColorBaseBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
                <FontIcon Glyph="&#xE8B7;" FontSize="24" Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                <TextBlock Text="Rclone GUI" Style="{StaticResource TitleTextBlockStyle}" FontWeight="SemiBold"/>
            </StackPanel>

            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                <Button x:Name="SettingsButton" 
                        ToolTipService.ToolTip="Settings"
                        Click="SettingsButton_Click"
                        Background="Transparent"
                        BorderBrush="Transparent">
                    <FontIcon Glyph="&#xE713;" FontSize="16"/>
                </Button>
            </StackPanel>
        </Grid>

        <!-- Navigation View -->
        <NavigationView x:Name="NavView"
                        Grid.Row="1"
                        IsBackButtonVisible="Collapsed"
                        IsSettingsVisible="False"
                        IsTitleBarAutoPaddingEnabled="False"
                        PaneDisplayMode="Left"
                        OpenPaneLength="200"
                        Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
                        SelectionChanged="NavView_SelectionChanged">

            <NavigationView.MenuItems>
                <NavigationViewItem Tag="drives" Content="Drives" IsSelected="True">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xEDA2;"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem Tag="add" Content="Add Connection">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE710;"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
            </NavigationView.MenuItems>

            <NavigationView.FooterMenuItems>
                <NavigationViewItem Tag="settings" Content="Settings">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE713;"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
            </NavigationView.FooterMenuItems>

            <!-- Content Frame -->
            <Frame x:Name="ContentFrame" Padding="24"/>
        </NavigationView>

        <!-- System Tray Icon -->
        <tb:TaskbarIcon x:Name="TrayIcon"
                        ToolTipText="Rclone GUI"
                        Visibility="Visible"
                        LeftClickCommand="{x:Null}"
                        NoLeftClickDelay="True"
                        DoubleClickCommand="{x:Null}">
            <tb:TaskbarIcon.ContextFlyout>
                <MenuFlyout>
                    <MenuFlyoutItem Text="Show Window" Click="TrayShow_Click">
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xE8A7;"/>
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                    <MenuFlyoutSeparator/>
                    <MenuFlyoutItem Text="Mount All" Click="TrayMountAll_Click">
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xE8CE;"/>
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                    <MenuFlyoutItem Text="Unmount All" Click="TrayUnmountAll_Click">
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xE8D8;"/>
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                    <MenuFlyoutSeparator/>
                    <MenuFlyoutItem Text="Exit" Click="TrayExit_Click">
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xE8BB;"/>
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                </MenuFlyout>
            </tb:TaskbarIcon.ContextFlyout>
        </tb:TaskbarIcon>
    </Grid>
</Window>
